<!DOCTYPE html>
<html>
<head>
    <title>Emergency Surgery Score</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        .main-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 100%;
            max-width: 1800px;
            margin: 0 auto;
        }
        .chart-container {
            height: 500px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .form-container {
            padding: 20px;
            background: #f5f5f5;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
        }
        .data-row {
            background: white;
            padding: 10px;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .data-row label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            font-size: 0.9em;
            color: #333;
        }
        .series-inputs {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        .series-inputs input {
            width: 60px;
            padding: 4px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .series-label {
            display: inline-block;
            width: 60px;
            font-size: 0.8em;
        }
        button {
            background: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 20px;
            font-size: 1em;
        }
        button:hover {
            background: #45a049;
        }
        .form-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="chart-container">
            <canvas id="emergencyChart"></canvas>
        </div>
        <div class="form-container">
            <div class="form-header">
                <h3 style="margin: 0;">Enter Values for Each Category</h3>
                <button type="button" onclick="updateChart()">Update Chart</button>
            </div>
            <form id="dataForm">
                <div id="inputFields" class="data-grid"></div>
            </form>
        </div>
    </div>

    <script>
        const labels = [
            "Age >60 yrs",
            "White race",
            "Transfer from outside emergency department",
            "Transfer from an inpatient facility",
            "Ascites",
            "BMI<20kg/m²",
            "History of disseminated cancer",
            "Dyspnoea",
            "Functional dependence",
            "History of COPD",
            "Hypertension",
            "Steroid use",
            "Preoperative ventilator requirement 48 hrs",
            "Weight loss >10% in last 6 months",
            "Albumin<3 U/L",
            "Alkaline phosphatase>125 U/L",
            "BUN >40",
            "Creatinine>1.2mg/dl",
            "INR>1.5",
            "Platelets <150×10 U/L",
            "Aspartate aminotransferase (AST; SGOT) >40",
            "Sodium >145 mg/dL",
            "White blood cells x 10/L",
            "Less than 4.5",
            "More than 15 and less than 25",
            "More than 25"
        ];

        // Create input fields
        const inputFields = document.getElementById('inputFields');
        labels.forEach((label, index) => {
            const div = document.createElement('div');
            div.className = 'data-row';
            div.innerHTML = `
                <label>${label}</label>
                <div class="series-inputs">
                    <span class="series-label" style="color: #fe117c">Series 1:</span>
                    <input type="number" step="0.1" value="0" id="s1_${index}">
                    <span class="series-label" style="color: #ffc069">Series 2:</span>
                    <input type="number" step="0.1" value="0" id="s2_${index}">
                    <span class="series-label" style="color: #06caf4">Series 3:</span>
                    <input type="number" step="0.1" value="0" id="s3_${index}">
                </div>
            `;
            inputFields.appendChild(div);
        });

        const ctx = document.getElementById('emergencyChart').getContext('2d');
        let myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: 'Series 1',
                        data: Array(26).fill(0),
                        backgroundColor: '#fe117c'
                    },
                    {
                        label: 'Series 2',
                        data: Array(26).fill(0),
                        backgroundColor: '#ffc069'
                    },
                    {
                        label: 'Series 3',
                        data: Array(26).fill(0),
                        backgroundColor: '#06caf4'
                    }
                ]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'Emergency Surgery Score',
                        color: '#000000',
                        font: {
                            size: 16
                        }
                    },
                    legend: {
                        display: true,
                        position: 'right'
                    }
                },
                scales: {
                    x: {
                        grid: {
                            lineWidth: 1
                        },
                        beginAtZero: true
                    },
                    y: {
                        grid: {
                            display: false
                        }
                    }
                }
            }
        });

        function updateChart() {
            const series1Data = [];
            const series2Data = [];
            const series3Data = [];

            for(let i = 0; i < labels.length; i++) {
                series1Data.push(parseFloat(document.getElementById(`s1_${i}`).value) || 0);
                series2Data.push(parseFloat(document.getElementById(`s2_${i}`).value) || 0);
                series3Data.push(parseFloat(document.getElementById(`s3_${i}`).value) || 0);
            }

            myChart.data.datasets[0].data = series1Data;
            myChart.data.datasets[1].data = series2Data;
            myChart.data.datasets[2].data = series3Data;
            myChart.update();
        }
    </script>
</body>
</html>